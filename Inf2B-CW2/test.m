dir = '/afs/inf.ed.ac.uk/group/teaching/inf2b/cwk2/d/s1728470';
[Xtrn, Ytrn, Xtst, Ytst] = load_my_data_set(dir);
%[EVecs, EVals, CumVar, MinDims] = task1_3(Xtrn);
%task1_4(EVecs);
%save('task1_3_evals.mat','EVals');
%save('task1_3_cumvar.mat','CumVar');
%save('task1_3_mindims.mat','MinDims');
Xtrn2 = double(Xtrn)./255.0;
Ytrn2 = double(Ytrn)./255.0;
Xtst2 = double(Xtst)./255.0;
Ytst2 = double(Ytst)./255.0;
%Ypreds2 = double(Ypreds)./255.0;
%comp_pca(Xtrn);
%M = task1_2(Xtrn, Ytrn);
%save('task1_2_%d.mat', 'M');
%[val, vect] = comp_pca(Xtrn);
%task1_3(Xtrn);
%task1_4(EVecs);
%Ks = [1,3,5];
%[Ypreds] = my_knn_classify(Xtrn2, Ytrn2, Xtst2, Ks);
%K = 10;
%[CM, acc] = comp_confmat(Ytrn2, Ypreds2, K);
%Ks = [1,2,3,4,5,7,10,15,20];
%[Ypreds]=my_knn_classify(Xtrn2, Ytrn2, Xtst2, Ks.');
%task1_5(Xtrn2,Ks);
%task1_4(EVecs);
%task1_6('task1_5_c_1.mat');
%Dmap = task1_7('task1_5_c_10.mat', 'task1_2_M.mat', 'task1_3_evecs.mat', 'task1_3_evals.mat', mean(Xtrn), 200);
%[C, idx,SSE] = my_kMeansClustering(Xtrn, 5, Xtrn(1:5, :), 100);
%Ks = [1,3,5,10,20];
%task2_1(Xtrn2, Ytrn, Xtst2, Ytst, 20);
%Ypreds = run_knn_classifier(Xtrn2, Ytrn, Xtst2,3)
%task2_5(Xtrn, Ytrn, Ytst, 0.01);
%Dmap = task2_2(Xtrn, Ytrn, 3,'task1_3_evecs.mat', 'task1_3_evals.mat', mean(Xtrn), 200);
%task2_3(Xtrn2, Ytrn);
%task2_5(Xtrn2, Ytrn, Xtst2, Ytst, 0.01);
%Dmap = task2_6(Xtrn2, Ytrn, 0.01,'task1_3_evecs.mat', 'task1_3_evals.mat', mean(Xtrn2), 200);
%[CM, acc] = task2_7(Xtrn2, Ytrn, Xtst2, Ytst, 0.01, 0.3);
[Corrs] = task2_4(Xtrn2, Ytrn);